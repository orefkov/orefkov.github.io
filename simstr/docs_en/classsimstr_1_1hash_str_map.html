<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>simstr: simstr::hashStrMap&lt; K, T, H, E &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">simstr<span id="projectnumber">&#160;1.6.0</span>
   </div>
   <div id="projectbrief">Yet another strings library</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classsimstr_1_1hash_str_map.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="classsimstr_1_1hash_str_map-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">simstr::hashStrMap&lt; K, T, H, E &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Container for more efficient searching by string keys.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sstring_8h_source.html">sstring.h</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename K, typename T, typename H = strhash&lt;K&gt;, typename E = streql&lt;K&gt;&gt;<br />
class simstr::hashStrMap&lt; K, T, H, E &gt;</div><p>Container for more efficient searching by string keys. </p>
<p>Used to store and lookup keys of any string type. Like unordered_map, but a little better. Stores <a class="el" href="structsimstr_1_1simple__str.html" title="The simplest immutable non-owning string class.">simple_str</a> as keys along with the calculated hash and an empty space for sstring. After insertion, creates an sstring in this empty space so that <a class="el" href="structsimstr_1_1simple__str.html" title="The simplest immutable non-owning string class.">simple_str</a> has something to refer to. Allows you to use any simstr string objects for insertion and search, creating an object from them sstring only for real insertion. Since C++20, unordered_map has the ability to perform heterogeneous search by key with type, different from the type of the key being stored, but this requires some dancing with hash types and comparisons. Search with insertion (try_emplace) by a type other than the key type appears in the standard only with C++26. There is a hashing and comparison implementation for the options:</p><ul>
<li>case sensitive</li>
<li>case insensitive, ASCII only</li>
<li>case insensitive, simplified Unicode (up to 0xFFFF). Hashing is performed by the FNV-1A algorithm. Automatic conversion of simstr string objects to the type of the stored key (i.e. with a calculated hash), and also saving sstring in the key when inserting - performed for the try_emplace, emplace, at, methods find, operator[], erase. When using other search methods, you need to provide the correct calculated hash in the StoreType key. Do not use insertion methods other than those listed; they are not will save sstring in the key.</li>
</ul>
<p>The main thing I would like to focus on is the very purpose of strHashMap, for which it was originally invented. The goal was not to somehow beat unordered_map in terms of performance/memory (otherwise why make strHashMap on unordered_map database?) The main problem that was solved is that we have several options for string objects, and I would like to be able to use any type of string object to insert and search for keys. We have <a class="el" href="structsimstr_1_1simple__str.html" title="The simplest immutable non-owning string class.">simple_str</a>, <a class="el" href="structsimstr_1_1simple__str__nt.html" title="A class that claims to refer to a null-terminated string.">simple_str_nt</a>, sstring, and <a class="el" href="classsimstr_1_1lstring.html" title="The mutable, owning string class. Contains an internal buffer for text of a given size.">lstring&lt;N&gt;</a> in general for every N is a new object type. In std everything was simple - there was only string, and accordingly, we used unordered_map&lt;string, Something there&gt;. And by the way, in std we encountered the same problem: the keys are const char*, and with C++17 and string_view (this is like our <a class="el" href="structsimstr_1_1simple__str.html" title="The simplest immutable non-owning string class.">simple_str</a>), searching in unordered_map&lt;string, Type&gt; is not very good, you have to convert the key to string every time, although you can do without this. Therefore, starting from C++20, the possibility of heterogeneous search was added to unordered_map - on <a href="https://en.cppreference.com/w/cpp/container/unordered_map/find">https://en.cppreference.com/w/cpp/container/unordered_map/find</a> these are syntaxes (3) and (4). True, this requires ritual dances with a tambourine - a special type is required for hashing (which, of course, in the standard is no longer included and you need to implement it yourself), which can hash different types of keys, and contains typename <code>is_transparent</code>. In fact, there is an example of it on the same page. This solved part of the problem - search, but did not solve the insertion problem - for inserting into unordered_map&lt;string, Type&gt; still only requires string. And only in the future C++26 we expect the possibility of heterogeneous insertion in the form try_emplace (<a href="https://en.cppreference.com/w/cpp/container/unordered_map/try_emplace">https://en.cppreference.com/w/cpp/container/unordered_map/try_emplace</a>) in syntax (6), which will allow you to accept keys of other types and convert them to the desired type only if the insertion is actually carried out. In my string library, I encountered this problem even before C++17, and so Iâ€™m not so cool as to influence the standard, I simply created my own class - a descendant of unordered_map, with wrappers around the insertion/search methods. Well, I also added two more hashing/comparison options: case-insensitive ASCII, case-insensitive simple unicode. Thus, we have a class that extends the standard unordered_map with the ability to work with string keys of different types, allowing you to avoid unnecessary unnecessary key conversions when searching and inserting. The fact that performance may improve is not the goal, but a side effect - pleasant, if there is one, but not fatal if it is not there. </p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="sstring_8h_source.html">sstring.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesimstr.html">simstr</a></li><li class="navelem"><a class="el" href="classsimstr_1_1hash_str_map.html">hashStrMap</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
